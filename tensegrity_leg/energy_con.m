function P = energy_con(q,l,k)  
    n = length(q)/6;
    x = zeros(6,n + 2);
    x(1:3,1) = [ 0
                 0
                 0 ];

    x(4:6,1) = [ 0
                 0.2
                 0 ]; 
    
    x(1:3,2) = [ 0.2
                 0
                 0 ];

    x(4:6,2) = [ 0.2
                 0.2
                 0 ]; 
    for i = 3:n+2
        x(1:3,i) = [ q((i-3)*6 + 1)
                     q((i-3)*6 + 2)
                     q((i-3)*6 + 3) ];

        x(4:6,i) = [ q((i-3)*6 + 1) + q((i-3)*6 + 4)
                     q((i-3)*6 + 2) + q((i-3)*6 + 5)
                     q((i-3)*6 + 3) + q((i-3)*6 + 6) ];
    end
    P = distance(x,8,1,5,1,1,l,k) + distance(x,8,1,1,1,2,l,k) + distance(x,8,1,2,1,3,l,k) + ...
        distance(x,8,1,5,2,4,l,k) + distance(x,9,1,5,1,5,l,k) + distance(x,9,1,1,2,6,l,k) + ...
        distance(x,9,1,2,2,7,l,k) + distance(x,9,1,5,2,8,l,k) + distance(x,1,2,6,1,9,l,k) + ...
        distance(x,1,1,6,1,10,l,k) + distance(x,2,2,6,2,11,l,k) + distance(x,2,1,6,2,12,l,k) + ...
        distance(x,3,2,6,1,13,l,k) + distance(x,3,1,6,1,14,l,k) + distance(x,4,2,6,2,15,l,k) + ...
        distance(x,4,1,6,2,16,l,k) + distance(x,4,2,7,2,17,l,k) + distance(x,4,1,7,2,18,l,k) + ...
        distance(x,3,2,7,1,19,l,k) + distance(x,3,1,7,1,20,l,k) + distance(x,8,2,7,1,21,l,k) + ...
        distance(x,8,2,3,1,22,l,k) + distance(x,8,2,4,1,23,l,k) + distance(x,8,2,7,2,24,l,k) + ...
        distance(x,9,2,7,1,25,l,k) + distance(x,9,2,3,2,26,l,k) + distance(x,9,2,4,2,27,l,k) + ...
        distance(x,9,2,7,2,28,l,k) + distance(x,5,1,1,2,29,l,k) + distance(x,5,1,1,1,30,l,k) + ...
        distance(x,5,2,2,2,31,l,k) + distance(x,5,2,2,1,32,l,k) + distance(x,3,1,1,1,33,l,k) + ...
        distance(x,3,2,1,2,34,l,k) + distance(x,4,2,2,2,35,l,k) + distance(x,4,1,2,1,36,l,k);
end     
% % 
% P = distance(x,8,1,5,1,l(1)) + distance(x,8,1,1,1,l(2)) + distance(x,8,1,2,1,l(3)) + ...
%         distance(x,8,1,5,2,l(4)) + distance(x,9,1,5,1,l(5)) + distance(x,9,1,1,2,l(6)) + ...
%         distance(x,9,1,2,2,l(7)) + distance(x,9,1,5,2,l(8)) + distance(x,1,2,6,1,l(9)) + ...
%         distance(x,1,1,6,1,l(10)) + distance(x,2,2,6,2,l(11)) + distance(x,2,1,6,2,l(12)) + ...
%         distance(x,3,2,6,1,l(13)) +  distance(x,3,1,6,1,l(14)) + distance(x,4,2,6,2,l(15)) + ...
%         distance(x,4,1,6,2,l(16)) + distance(x,4,2,7,2,l(17)) + distance(x,4,1,7,2,l(18)) + ...
%         distance(x,3,2,7,1,l(19)) +  distance(x,3,1,7,1,l(20)) + distance(x,8,2,7,1,l(21)) + ...
%         distance(x,8,2,3,1,l(22)) + distance(x,8,2,4,1,l(23)) + distance(x,8,2,7,2,l(24)) + ...
%         distance(x,9,2,7,1,l(25)) + distance(x,9,2,3,2,l(26)) + distance(x,9,2,4,2,l(27)) + ...
%         distance(x,9,2,7,2,l(28)) + distance(x,5,1,1,2,l(29)) + distance(x,5,1,1,1,l(30)) + ...
%         distance(x,5,2,2,2,l(31)) + distance(x,5,2,2,1,l(32)) + distance(x,3,1,9,1,l(33)) + ...
%         distance(x,3,2,1,2,l(34)) + distance(x,4,2,2,2,l(35)) + distance(x,4,1,2,1,l(36));